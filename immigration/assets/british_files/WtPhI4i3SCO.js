/*!CK:2086306991!*//*1456276709,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["8Fjr9"]); }

__d('P2PMemoField.react',['CurrentEnvironment','Image.react','P2PGKValues','P2PMemoPhotoUploadPreview.react','P2PMemoPhotoUploadSelector.react','React','cx','fbt','ix'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';if(c.__markCompiled)c.__markCompiled();var q=m.PropTypes,r=m.createClass({displayName:'P2PMemoField',propTypes:{defaultValue:q.string,disabled:q.bool,isRequesting:q.bool,onTextChange:q.func.isRequired,onPhotoChange:q.func.isRequired,onPhotoUploadingChange:q.func.isRequired},getInitialState:function(){return {attachedPhoto:null,defaultValue:'',disabled:false,focused:false,isRequesting:false,photoUploading:false};},handleChangeText:function(s){this.props.onTextChange(s.target.value);},handleImageClick:function(){this.refs.input.focus();},handleFocus:function(){this.setState({focused:true});},handleBlur:function(){this.setState({focused:false});},handlePhotoUploadStart:function(){this.setState({photoUploading:true});this.props.onPhotoUploadingChange(true);},handlePhotoUploadComplete:function(s){var t=s.payload||null;this.setState({attachedPhoto:t,photoUploading:false});this.props.onPhotoChange(t?[t.fbid]:[]);this.props.onPhotoUploadingChange(false);},handlePhotoRemove:function(){this.setState({attachedPhoto:null,photoUploading:false});this.props.onPhotoChange([]);this.props.onPhotoUploadingChange(false);},getImageSrc:function(){var s=h.messengerdotcom;if(this.state.focused){if(s){return p('/images/p2p/memo-pencil-messenger-blue.png');}else return p('/images/p2p/memo-pencil-www-blue.png');}else if(s){return p('/images/p2p/memo-pencil-messenger-gray.png');}else return p('/images/p2p/memo-pencil-www-gray.png');},getPlaceholder:function(){if(this.props.isRequesting)return o._("What is this request for?");return o._("What is this payment for?");},shouldRenderPhotoMemo:function(){return j.P2PWWWMemoPhotoEnabled&&!this.props.isRequesting;},renderPhotoUploadSelector:function(){if(!this.shouldRenderPhotoMemo())return null;return (m.createElement('div',{className:"_1-j-"},m.createElement(l,{attachedPhoto:this.state.attachedPhoto,photoUploading:this.state.photoUploading,onPhotoUploadComplete:this.handlePhotoUploadComplete,onPhotoUploadStart:this.handlePhotoUploadStart})));},renderPhotoUploadPreview:function(){if(!this.shouldRenderPhotoMemo())return null;return (m.createElement(k,{attachedPhoto:this.state.attachedPhoto,photoUploading:this.state.photoUploading,onRemoveButtonClick:this.handlePhotoRemove}));},render:function(){return (m.createElement('div',{className:"_2z8p"},m.createElement('div',{className:"_1-j_"},m.createElement(i,{className:"_2z8q",height:12,onClick:this.handleImageClick,src:this.getImageSrc(),width:12}),m.createElement('input',{className:"_2z8r",defaultValue:this.props.defaultValue,disabled:this.props.disabled,maxLength:36,onChange:this.handleChangeText,onBlur:this.handleBlur,onFocus:this.handleFocus,placeholder:this.getPlaceholder(),ref:'input'}),this.renderPhotoUploadSelector()),this.renderPhotoUploadPreview()));}});f.exports=r;},null);